{"openapi":"3.0.1","info":{"title":"Product Service API","description":"통신요금 관리 서비스 - 상품 변경 및 관리 API","contact":{"name":"PhoneBill Development Team","email":"dev@phonebill.com"},"version":"1.0.0"},"servers":[{"url":"http://localhost:8083","description":"Local Development"},{"url":"{protocol}://{host}:{port}","description":"Custom Server","variables":{"protocol":{"description":"Protocol (http or https)","default":"http","enum":["http","https"]},"host":{"description":"Server host","default":"localhost"},"port":{"description":"Server port","default":"8083"}}}],"security":[{"bearerAuth":[]}],"tags":[{"name":"Product Change Service","description":"상품변경 서비스 API"}],"paths":{"/api/v1/products/change":{"post":{"tags":["Product Change Service"],"summary":"상품변경 요청","description":"실제 상품변경 처리를 요청합니다 (동기 처리)","operationId":"requestProductChange","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ProductChangeRequest"}}},"required":true},"responses":{"200":{"description":"상품변경 처리 완료","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ProductChangeResponse"}}}},"500":{"description":"서버 오류","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"409":{"description":"사전체크 실패 또는 처리 불가 상태","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"503":{"description":"KOS 시스템 장애 (Circuit Breaker Open)","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"400":{"description":"잘못된 요청","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}}},"security":[{"bearerAuth":[]}]}},"/api/v1/products/change/validation":{"post":{"tags":["Product Change Service"],"summary":"상품변경 사전체크","description":"상품변경 요청 전 사전체크를 수행합니다","operationId":"validateProductChange","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ProductChangeValidationRequest"}}},"required":true},"responses":{"500":{"description":"서버 오류","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"400":{"description":"잘못된 요청","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"200":{"description":"사전체크 완료 (성공/실패 포함)","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ProductChangeValidationResponse"}}}}},"security":[{"bearerAuth":[]}]}},"/api/v1/products/history":{"get":{"tags":["Product Change Service"],"summary":"상품변경 이력 조회","description":"고객의 상품변경 이력을 조회합니다","operationId":"getProductChangeHistory","parameters":[{"name":"lineNumber","in":"query","description":"회선번호 (미입력시 로그인 고객 기준)","required":false,"schema":{"pattern":"^010[0-9]{8}$","type":"string"}},{"name":"startDate","in":"query","description":"조회 시작일 (YYYY-MM-DD)","required":false,"schema":{"type":"string"}},{"name":"endDate","in":"query","description":"조회 종료일 (YYYY-MM-DD)","required":false,"schema":{"type":"string"}},{"name":"page","in":"query","description":"페이지 번호 (1부터 시작)","required":false,"schema":{"type":"integer","format":"int32","default":1}},{"name":"size","in":"query","description":"페이지 크기","required":false,"schema":{"type":"integer","format":"int32","default":10}}],"responses":{"500":{"description":"서버 오류","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"400":{"description":"잘못된 요청","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"200":{"description":"이력 조회 성공","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ProductChangeHistoryResponse"}}}}},"security":[{"bearerAuth":[]}]}},"/api/v1/products/customer":{"get":{"tags":["Product Change Service"],"summary":"고객 정보 조회","description":"특정 회선번호의 고객 정보와 현재 상품 정보를 조회합니다","operationId":"getCustomerInfo","parameters":[{"name":"lineNumber","in":"query","description":"고객 회선번호","required":true,"schema":{"pattern":"^010[0-9]{8}$","type":"string"},"example":"01012345678"}],"responses":{"500":{"description":"서버 오류","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"200":{"description":"고객 정보 조회 성공","content":{"*/*":{"schema":{"$ref":"#/components/schemas/CustomerInfoResponse"}}}},"400":{"description":"잘못된 요청","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"404":{"description":"고객 정보를 찾을 수 없음","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}}},"security":[{"bearerAuth":[]}]}},"/api/v1/products/available":{"get":{"tags":["Product Change Service"],"summary":"변경 가능한 상품 목록 조회","description":"현재 판매중이고 변경 가능한 상품 목록을 조회합니다","operationId":"getAvailableProducts","parameters":[{"name":"currentProductCode","in":"query","description":"현재 상품코드 (필터링용)","required":false,"schema":{"type":"string"}}],"responses":{"200":{"description":"상품 목록 조회 성공","content":{"*/*":{"schema":{"$ref":"#/components/schemas/AvailableProductsResponse"}}}},"500":{"description":"서버 오류","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}}},"security":[{"bearerAuth":[]}]}}},"components":{"schemas":{"ProductChangeRequest":{"required":["currentProductCode","lineNumber","targetProductCode"],"type":"object","properties":{"lineNumber":{"pattern":"^010[0-9]{8}$","type":"string"},"currentProductCode":{"type":"string"},"targetProductCode":{"type":"string"}}},"ProductChangeData":{"required":["processStatus","requestId","resultCode"],"type":"object","properties":{"requestId":{"type":"string"},"processStatus":{"type":"string","enum":["COMPLETED","FAILED"]},"resultCode":{"type":"string"},"resultMessage":{"type":"string"},"changedProduct":{"$ref":"#/components/schemas/ProductInfoDto"},"processedAt":{"type":"string","format":"date-time"}}},"ProductChangeResponse":{"required":["success"],"type":"object","properties":{"success":{"type":"boolean"},"data":{"$ref":"#/components/schemas/ProductChangeData"}}},"ProductInfoDto":{"type":"object","properties":{"productCode":{"type":"string","description":"상품 코드","example":"PLAN001"},"productName":{"type":"string","description":"상품명","example":"5G 프리미엄 플랜"},"monthlyFee":{"type":"number","description":"월 요금","example":55000},"dataAllowance":{"type":"string","description":"데이터 제공량","example":"100GB"},"voiceAllowance":{"type":"string","description":"음성 제공량","example":"무제한"},"smsAllowance":{"type":"string","description":"SMS 제공량","example":"기본 무료"},"operatorCode":{"type":"string","description":"사업자 코드","example":"MVNO001"},"description":{"type":"string","description":"상품 설명"},"available":{"type":"boolean"}},"description":"상품 정보"},"ErrorData":{"required":["code","message"],"type":"object","properties":{"code":{"type":"string"},"message":{"type":"string"},"details":{"type":"string"},"timestamp":{"type":"string","format":"date-time"},"path":{"type":"string"}}},"ErrorResponse":{"required":["success"],"type":"object","properties":{"success":{"type":"boolean"},"error":{"$ref":"#/components/schemas/ErrorData"}}},"ProductChangeValidationRequest":{"required":["currentProductCode","lineNumber","targetProductCode"],"type":"object","properties":{"lineNumber":{"pattern":"^010[0-9]{8}$","type":"string"},"currentProductCode":{"type":"string"},"targetProductCode":{"type":"string"}}},"ProductChangeValidationResponse":{"required":["success"],"type":"object","properties":{"success":{"type":"boolean"},"data":{"$ref":"#/components/schemas/ValidationData"}}},"ValidationData":{"required":["validationResult"],"type":"object","properties":{"validationResult":{"type":"string","enum":["SUCCESS","FAILURE"]},"validationDetails":{"type":"array","items":{"$ref":"#/components/schemas/ValidationDetail"}},"failureReason":{"type":"string"}}},"ValidationDetail":{"type":"object","properties":{"checkType":{"type":"string","enum":["PRODUCT_AVAILABLE","OPERATOR_MATCH","LINE_STATUS"]},"result":{"type":"string","enum":["PASS","FAIL"]},"message":{"type":"string"}}},"HistoryData":{"required":["history"],"type":"object","properties":{"history":{"type":"array","items":{"$ref":"#/components/schemas/ProductChangeHistoryItem"}},"pagination":{"$ref":"#/components/schemas/PaginationInfo"}}},"PaginationInfo":{"required":["page","size","totalElements","totalPages"],"type":"object","properties":{"page":{"type":"integer","format":"int32"},"size":{"type":"integer","format":"int32"},"totalElements":{"type":"integer","format":"int64"},"totalPages":{"type":"integer","format":"int32"},"hasNext":{"type":"boolean"},"hasPrevious":{"type":"boolean"}}},"ProductChangeHistoryItem":{"required":["lineNumber","processStatus","requestId"],"type":"object","properties":{"requestId":{"type":"string"},"lineNumber":{"type":"string"},"processStatus":{"type":"string"},"currentProductCode":{"type":"string"},"currentProductName":{"type":"string"},"targetProductCode":{"type":"string"},"targetProductName":{"type":"string"},"requestedAt":{"type":"string","format":"date-time"},"processedAt":{"type":"string","format":"date-time"},"resultMessage":{"type":"string"}}},"ProductChangeHistoryResponse":{"required":["success"],"type":"object","properties":{"success":{"type":"boolean"},"data":{"$ref":"#/components/schemas/HistoryData"}}},"ContractInfo":{"type":"object","properties":{"contractDate":{"type":"string","format":"date"},"termEndDate":{"type":"string","format":"date"},"earlyTerminationFee":{"type":"number"}}},"CustomerInfo":{"required":["currentProduct","customerId","customerName","lineNumber","lineStatus"],"type":"object","properties":{"customerId":{"type":"string"},"lineNumber":{"pattern":"^010[0-9]{8}$","type":"string"},"customerName":{"type":"string"},"currentProduct":{"$ref":"#/components/schemas/ProductInfoDto"},"lineStatus":{"type":"string"},"contractInfo":{"$ref":"#/components/schemas/ContractInfo"}}},"CustomerInfoResponse":{"required":["success"],"type":"object","properties":{"success":{"type":"boolean"},"data":{"$ref":"#/components/schemas/CustomerInfo"}}},"AvailableProductsResponse":{"required":["success"],"type":"object","properties":{"success":{"type":"boolean"},"data":{"$ref":"#/components/schemas/ProductsData"}}},"ProductsData":{"required":["products"],"type":"object","properties":{"products":{"type":"array","items":{"$ref":"#/components/schemas/ProductInfoDto"}},"totalCount":{"type":"integer","format":"int32"}}}},"securitySchemes":{"bearerAuth":{"type":"http","scheme":"bearer","bearerFormat":"JWT"}}}}